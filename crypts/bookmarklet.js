javascript:(function(){(function(){var WIN=window;WIN.havitatKernel=WIN.havitatKernel||(function(){function Bus(){this.subscribers={};}Bus.prototype.on=function(e,i,f,p){p=p||0;this.subscribers[e]=this.subscribers[e]||[];this.subscribers[e].push({id:i,fn:f,priority:p});this.subscribers[e].sort(function(a,b){return b.priority-a.priority;});};Bus.prototype.off=function(e,i){if(!this.subscribers[e])return;this.subscribers[e]=this.subscribers[e].filter(s=>s.id!==i);};Bus.prototype.emit=function(e,ev){var s=this.subscribers[e]||[];for(var i=0;i<s.length;i++){try{s[i].fn(ev);}catch(err){console.error('bus handler',err);}}};var bus=new Bus();var globalEvents=['click','mousemove','keydown','keyup','wheel','mousedown','mouseup','contextmenu'];globalEvents.forEach(function(ev){document.addEventListener(ev,function(e){try{bus.emit(ev,e);}catch(err){console.error(err);}},true);});var processes={};function registerProcess(s){if(!s||!s.id)throw new Error('process needs id');if(processes[s.id])return processes[s.id];var p={id:s.id,type:s.type||'tool',active:!!s.active,start:function(){if(s.start){var r=s.start();p.active=true;return r;}p.active=true;},stop:function(){if(s.stop){var r=s.stop();p.active=false;return r;}p.active=false;},teardown:s.teardown||function(){},meta:s.meta||{}};processes[s.id]=p;return p;}function toggleProcess(i){var p=processes[i];if(!p)return null;if(p.active){p.stop();return{id:i,action:'stopped'};}else{p.start();return{id:i,action:'started'};}}function listProcesses(){return Object.keys(processes).map(function(k){var pr=processes[k];return{id:pr.id,type:pr.type,active:!!pr.active,meta:pr.meta};});}function getCssPath(el){if(!el||!el.tagName)return'';var path=[];var node=el;while(node&&node.nodeType===1&&node.tagName.toLowerCase()!=='html'){var selector=node.tagName.toLowerCase();if(node.id)selector+='#'+node.id;else if(node.className&&typeof node.className==='string'&&node.className.trim()){selector+='.'+node.className.trim().split(/\s+/).join('.');}else{var sib=node,idx=1;while((sib=sib.previousElementSibling)!=null){if(sib.tagName===node.tagName)idx++;}selector+=':nth-of-type('+idx+')';}path.unshift(selector);node=node.parentElement;}return path.join(' > ');}function wrap(el){if(!el||!el.getBoundingClientRect)return null;var r=el.getBoundingClientRect();var styles=window.getComputedStyle(el);var depth=0;var p=el;while(p&&p.parentElement){depth++;p=p.parentElement;}var z=styles.zIndex==='auto'?0:(parseInt(styles.zIndex,10)||0);var role=el.getAttribute('role')||el.tagName.toLowerCase();return{raw:el,box:{left:r.left,top:r.top,width:r.width,height:r.height,right:r.right,bottom:r.bottom},depth:depth,z:z,role:role,display:styles.display,visibility:styles.visibility,path:getCssPath(el),flags:{clickable:(el.onclick||el.tagName==='A'||el.tagName==='BUTTON'||el.tabIndex>=0),scrollable:(styles.overflowX!=='visible'||styles.overflowY!=='visible'),overflowHidden:(styles.overflow==='hidden'||styles.overflowX==='hidden'||styles.overflowY==='hidden')}};}function scan(r){r=r||document.body;function w(el,a){var wr=wrap(el);if(wr)a.push(wr);Array.from(el.children||[]).forEach(function(ch){w(ch,a);});return a;}return w(r,[]);}function execCommand(c){c=(c||'').trim();if(!c)return'empty';var p=c.split(/\s+/);var cmd=p[0].toLowerCase();var a=p[1];if(cmd==='ps'||cmd==='list')return listProcesses();if(cmd==='start'&&a)return kernel.start(a);if(cmd==='stop'&&a)return kernel.stop(a);if(cmd==='toggle'&&a)return toggleProcess(a);if(cmd==='kill'&&a)return kernel.kill(a);if(cmd==='scan')return scan(a?document.querySelector(a):document.body);if(cmd==='wrap'&&a){var el=document.querySelector(a);return wrap(el);}return'unknown command: '+c;}return{bus:bus,register:registerProcess,toggle:toggleProcess,start:function(i){var p=processes[i];if(!p)return null;p.start();return{id:i,action:'started'};},stop:function(i){var p=processes[i];if(!p)return null;p.stop();return{id:i,action:'stopped'};},kill:function(i){var p=processes[i];if(!p)return null;try{p.stop();p.teardown();}catch(e){console.error(e);}delete processes[i];return{id:i,action:'killed'};},list:listProcesses,wrap:wrap,scan:scan,exec:execCommand,_internal:{processes:processes}}})();var kernel=window.havitatKernel;var activeViewerId=null;var effectStates={'blur':false,'grayscale':false};var d=document;var h=d.head;var style=d.createElement('style');style.textContent='::-webkit-scrollbar{width:4px;height:4px}::-webkit-scrollbar-track{background-color:#1B1C1C}::-webkit-scrollbar-thumb{background-color:#986C98}::-webkit-scrollbar-button{display:none}';h.appendChild(style);function activateLineTool(o){var tL='havitat-temp-line';var fL='havitat-final-line';var b=d.body;function c(){var t=d.getElementById(tL);if(t)t.remove();d.removeEventListener('mousemove',mH);d.removeEventListener('click',cH,true);activeViewerId=null;}function mH(e){var l=d.getElementById(tL);if(!l){l=d.createElement('div');l.id=tL;l.style.cssText='position:absolute;pointer-events:none;z-index:2147483646;opacity:0.7;background-color:#8AB6BB;';b.appendChild(l);}var sX=window.scrollX;var sY=window.scrollY;if(o==='v'){l.style.left=(e.clientX+sX)+'px';l.style.top='0';l.style.width='1px';l.style.height=Math.max(b.scrollHeight,d.documentElement.scrollHeight)+'px';}else{l.style.top=(e.clientY+sY)+'px';l.style.left='0';l.style.height='1px';l.style.width='100%';}}function cH(e){e.preventDefault();e.stopPropagation();var f=d.createElement('div');f.className=fL;f.style.cssText='position:absolute;pointer-events:none;z-index:2147483645;background-color:#986C98;';var sX=window.scrollX;var sY=window.scrollY;if(o==='v'){f.style.left=(e.clientX+sX)+'px';f.style.top='0';f.style.width='2px';f.style.height=Math.max(b.scrollHeight,d.documentElement.scrollHeight)+'px';}else{f.style.top=(e.clientY+sY)+'px';f.style.left='0';f.style.height='2px';f.style.width='100%';}b.appendChild(f);c();}c();d.addEventListener('mousemove',mH);d.addEventListener('click',cH,true);}var scripts={'xray-full':function(){var i='havitat-xray',b=d.body,w=window,ov=d.getElementById(i);if(ov){ov.remove();return;}ov=d.createElement('div');ov.id=i;ov.style.cssText='position:absolute;top:0;left:0;width:100%;height:'+Math.max(b.scrollHeight,d.documentElement.scrollHeight)+'px;pointer-events:none;z-index:2147483647;overflow:hidden;';b.appendChild(ov);function c(n){return n<=4?'rgba(255,50,50,0.4)':n<=6?'rgba(50,200,50,0.4)':'rgba(50,50,255,0.4)'}function p(r,dp){var k=c(dp),sx=w.scrollX,sy=w.scrollY,cx=r.left+sx+r.width/2,cy=r.top+sy+r.height/2,s='position:absolute;background:'+k+';',h=d.createElement('div'),v=d.createElement('div');h.style.cssText=s+'height:1px;width:'+r.width+'px;left:'+(r.left+sx)+'px;top:'+cy+'px';v.style.cssText=s+'width:1px;height:'+r.height+'px;top:'+(r.top+sy)+'px;left:'+cx+'px';ov.appendChild(h);ov.appendChild(v);}function t(e,n){if(n>8||e.id===i||['SCRIPT','STYLE','SVG','PATH'].indexOf(e.tagName)!==-1)return;var r=e.getBoundingClientRect();if(r.width>5&&r.height>5)p(r,n);var ch=e.children;for(var j=0;j<ch.length;j++)t(ch[j],n+1);}t(b,1);},'xray-top':function(){var s=1,e=4,i='havitat-xray-top',b=d.body,w=window,ov=d.getElementById(i);if(ov){ov.remove();return;}ov=d.createElement('div');ov.id=i;ov.style.cssText='position:absolute;top:0;left:0;width:100%;height:'+Math.max(b.scrollHeight,d.documentElement.scrollHeight)+'px;pointer-events:none;z-index:2147483647;overflow:hidden;';b.appendChild(ov);function c(n){var x=n-s;return x===0?'rgba(255,50,50,0.4)':x<=2?'rgba(50,200,50,0.4)':'rgba(50,50,255,0.4)'}function p(r,dp){var k=c(dp),sx=w.scrollX,sy=w.scrollY,cx=r.left+sx+r.width/2,cy=r.top+sy+r.height/2,st='position:absolute;background:'+k+';',h=d.createElement('div'),v=d.createElement('div');h.style.cssText=st+'height:1px;width:'+r.width+'px;left:'+(r.left+sx)+'px;top:'+cy+'px';v.style.cssText=st+'width:1px;height:'+r.height+'px;top:'+(r.top+sy)+'px;left:'+cx+'px';ov.appendChild(h);ov.appendChild(v);}function t(el,n){if(n>e||el.id&&el.id.indexOf('havitat')!==-1||['SCRIPT','STYLE','SVG','PATH'].indexOf(el.tagName)!==-1)return;var r=el.getBoundingClientRect();if(r.width>5&&r.height>5&&n>=s)p(r,n);var ch=el.children;for(var j=0;j<ch.length;j++)t(ch[j],n+1);}t(b,1);},'xray-mid':function(){var s=5,e=8,i='havitat-xray-mid',b=d.body,w=window,ov=d.getElementById(i);if(ov){ov.remove();return;}ov=d.createElement('div');ov.id=i;ov.style.cssText='position:absolute;top:0;left:0;width:100%;height:'+Math.max(b.scrollHeight,d.documentElement.scrollHeight)+'px;pointer-events:none;z-index:2147483647;overflow:hidden;';b.appendChild(ov);function c(n){var x=n-s;return x===0?'rgba(255,50,50,0.4)':x<=2?'rgba(50,200,50,0.4)':'rgba(50,50,255,0.4)'}function p(r,dp){var k=c(dp),sx=w.scrollX,sy=w.scrollY,cx=r.left+sx+r.width/2,cy=r.top+sy+r.height/2,st='position:absolute;background:'+k+';',h=d.createElement('div'),v=d.createElement('div');h.style.cssText=st+'height:1px;width:'+r.width+'px;left:'+(r.left+sx)+'px;top:'+cy+'px';v.style.cssText=st+'width:1px;height:'+r.height+'px;top:'+(r.top+sy)+'px;left:'+cx+'px';ov.appendChild(h);ov.appendChild(v);}function t(el,n){if(n>e||el.id&&el.id.indexOf('havitat')!==-1||['SCRIPT','STYLE','SVG','PATH'].indexOf(el.tagName)!==-1)return;var r=el.getBoundingClientRect();if(r.width>5&&r.height>5&&n>=s)p(r,n);var ch=el.children;for(var j=0;j<ch.length;j++)t(ch[j],n+1);}t(b,1);},'xray-bot':function(){var s=9,e=12,i='havitat-xray-bot',b=d.body,w=window,ov=d.getElementById(i);if(ov){ov.remove();return;}ov=d.createElement('div');ov.id=i;ov.style.cssText='position:absolute;top:0;left:0;width:100%;height:'+Math.max(b.scrollHeight,d.documentElement.scrollHeight)+'px;pointer-events:none;z-index:2147483647;overflow:hidden;';b.appendChild(ov);function c(n){var x=n-s;return x===0?'rgba(255,50,50,0.4)':x<=2?'rgba(50,200,50,0.4)':'rgba(50,50,255,0.4)'}function p(r,dp){var k=c(dp),sx=w.scrollX,sy=w.scrollY,cx=r.left+sx+r.width/2,cy=r.top+sy+r.height/2,st='position:absolute;background:'+k+';',h=d.createElement('div'),v=d.createElement('div');h.style.cssText=st+'height:1px;width:'+r.width+'px;left:'+(r.left+sx)+'px;top:'+cy+'px';v.style.cssText=st+'width:1px;height:'+r.height+'px;top:'+(r.top+sy)+'px;left:'+cx+'px';ov.appendChild(h);ov.appendChild(v);}function t(el,n){if(n>e||el.id&&el.id.indexOf('havitat')!==-1||['SCRIPT','STYLE','SVG','PATH'].indexOf(el.tagName)!==-1)return;var r=el.getBoundingClientRect();if(r.width>5&&r.height>5&&n>=s)p(r,n);var ch=el.children;for(var j=0;j<ch.length;j++)t(ch[j],n+1);}t(b,1);},'grid-h':function(remSize){var i='havitat-grid-h',b=d.body,e=d.documentElement,ov=d.getElementById(i);if(ov){ov.remove();return;}var h=Math.max(b.scrollHeight,e.scrollHeight),t=d.createElement('div');t.style.cssText='height:1rem;visibility:hidden;';b.appendChild(t);var remPx=t.offsetHeight;b.removeChild(t);var p=remSize*remPx;if(p<=0)return;var h_win=e.clientHeight,n=Math.floor(h_win/p);ov=d.createElement('div');ov.id=i;ov.style.cssText='position:absolute;top:0;left:0;width:100%;height:'+h+'px;pointer-events:none;z-index:9999;overflow:hidden;';b.appendChild(ov);for(var j=0;j<n;j++){var l=d.createElement('div');l.style.cssText='position:absolute;left:0;height:1px;width:100%;background-color:rgba(0,0,255,0.4);top:'+(j*p)+'px;';ov.appendChild(l);}},'grid-v':function(remSize){var i='havitat-grid-v',b=d.body,e=d.documentElement,ov=d.getElementById(i);if(ov){ov.remove();return;}var h=Math.max(b.scrollHeight,e.scrollHeight),t=d.createElement('div');t.style.cssText='width:1rem;visibility:hidden;';b.appendChild(t);var remPx=t.offsetWidth;b.removeChild(t);var p=remSize*remPx;if(p<=0)return;var w=e.clientWidth,n=Math.floor(w/p);ov=d.createElement('div');ov.id=i;ov.style.cssText='position:absolute;top:0;left:0;width:100%;height:'+h+'px;pointer-events:none;z-index:9999;overflow:hidden;';b.appendChild(ov);for(var j=0;j<n;j++){var l=d.createElement('div');l.style.cssText='position:absolute;top:0;width:1px;height:100%;background-color:rgba(255,0,0,0.4);left:'+(j*p)+'px;';ov.appendChild(l);}},'all-fonts':function(){const fontList=Array.from(d.fonts.keys()).map(fontFace=>fontFace.family).join('\n');return fontList||'No fonts found via document.fonts API.';},'print-json':function(){function syntaxHighlight(json){var json=JSON.stringify(json,undefined,4);json=json.replace(/&/g,'&').replace(/</g,'<').replace(/>/g,'>');return json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(match){var cls='color: #AAABAC;';if(/^"/.test(match)){if(/:$/.test(match)){cls='color: #986C98;'}else{cls='color: #8AB6BB;'}}else if(/true|false/.test(match)){cls='color: #FF5050;'}else if(/null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/.test(match)){cls='color: #C080FF;'}return '<span style="'+cls+'">'+match+'</span>';});}var contentType=d.contentType;if(contentType==='application/json'){var json=JSON.parse(d.body.innerText);return syntaxHighlight(json);}else{return 'This page does not contain JSON.';}},'log-global':function(){var content=Object.getOwnPropertyNames(window).join('\n');return content;},'log-domtree':function(){function asciiTree(node,prefix,isLast){if(node.nodeType!==1)return'';var name=node.tagName.toLowerCase();if(node.id)name+='#'+node.id;if(typeof node.className==='string'&&node.className.trim()){name+='.'+node.className.trim().replace(/\s+/g,'.');}var connector=isLast?'\u2514\u2500 ':'\u251c\u2500 ';var out=prefix+connector+name+'\n';var newPrefix=prefix+(isLast?'\u00a0 \u00a0':'\u2502\u00a0 ');var children=Array.from(node.children);for(var j=0;j<children.length;j++)out+=asciiTree(children[j],newPrefix,j===children.length-1);return out;}var tree=asciiTree(d.body,'',true);return tree;},'activate-colors':function(){function rc(){var s='0123456789ABCDEF',c='#';for(var j=0;j<6;j++)c+=s[Math.floor(Math.random()*16)];return c;}function ct(c){var h=c.slice(1),r=parseInt(h.substr(0,2),16),g=parseInt(h.substr(2,2),16),b=parseInt(h.substr(4,2),16),y=(r*299+g*587+b*114)/1000;return y>=128?'#000':'#FFF';}function apply(el){var bg=rc();el.style.backgroundColor=bg;el.style.color=ct(bg);}var els=d.getElementsByTagName('*');for(var j=0;j<els.length;j++)apply(els[j]);},'v-line':function(){activateLineTool('v');},'h-line':function(){activateLineTool('h');},'blur':function(){effectStates.blur=!effectStates.blur;updateBodyFilter();},'grayscale':function(){effectStates.grayscale=!effectStates.grayscale;updateBodyFilter();},'img-flip':function(){var b=d.body,angle=parseInt(b.dataset.imgFlipAngle||0);var newAngle=angle+90;['','-ms-','-webkit-','-o-','-moz-'].forEach(function(p){Array.from(d.querySelectorAll('img')).forEach(function(el){el.style[p+'transform']='rotate('+newAngle+'deg)';el.style[p+'transition']='transform 0.3s ease';});});b.dataset.imgFlipAngle=newAngle;},'el-sniper':function(){function cursor(c){d.body.style.cursor=c;}if(d.body.style.cursor==='crosshair'){for(var j=0;j<(d.getElementsByTagName('a')).length;j++){(d.getElementsByTagName('a')[j]).style.pointerEvents='initial';}d.removeEventListener('click',window.elSniperHandler,true);cursor('default');window.elSniperActive=false;}else{window.elSniperHandler=function(e){e=e||window.event;var t=e.target||e.srcElement;t.style.display='none';d.removeEventListener('click',window.elSniperHandler,true);cursor('default');for(var j=0;j<(d.getElementsByTagName('a')).length;j++){(d.getElementsByTagName('a')[j]).style.pointerEvents='initial';}window.elSniperActive=false;var b=d.getElementById('el-sniper_btn');if(b){b.textContent='off';b.style.backgroundColor='#986C98';}};for(var j=0;j<(d.getElementsByTagName('a')).length;j++){(d.getElementsByTagName('a')[j]).style.pointerEvents='none';}d.addEventListener('click',window.elSniperHandler,true);cursor('crosshair');window.elSniperActive=true;}},'el-size':function(){window.getElementSize=window.getElementSize||{};if(typeof getElementSize.isActive==='undefined'){getElementSize.isActive=!1;getElementSize.style=d.createElement('style');getElementSize.style.innerText=".get-element-size{z-index:1000000000;position:absolute;top:0;left:0;opacity:0;pointer-events:none;outline:0!important}.get-element-size__overlay{width:1px;height:1px;background-color:#8AB6BB25;transform-origin:0 0;transition:transform 50ms ease;outline:0!important;position:absolute}.get-element-size__label{padding:3px 8px;border:1px solid #986C98;border-radius:0;background-color:#1B1C1C;font-family:Inconsolata, monospace;color:#AAABAC!important;font-size:12px!important;line-height:1.5rem;transform-origin:0 0;outline:0!important;position:absolute;z-index:1000000001}";h.appendChild(getElementSize.style);getElementSize.container=d.createElement('div');getElementSize.container.classList.add('get-element-size');d.body.appendChild(getElementSize.container);getElementSize.overlay=d.createElement('div');getElementSize.overlay.classList.add('get-element-size__overlay');getElementSize.container.appendChild(getElementSize.overlay);getElementSize.label=d.createElement('div');getElementSize.label.classList.add('get-element-size__label');getElementSize.container.appendChild(getElementSize.label);getElementSize.update=(event)=>{let rect=event.target.getBoundingClientRect();let overlayX=window.pageXOffset+rect.left;let overlayY=window.pageYOffset+rect.top;let overlayWidth=rect.width;let overlayHeight=rect.height;getElementSize.overlay.style.transform=%60translate(${overlayX}px, ${overlayY}px) scale(${overlayWidth}, ${overlayHeight})%60;let labelX=window.pageXOffset+event.clientX+8;let labelY=window.pageYOffset+event.clientY+16;getElementSize.label.style.transform=%60translate(${labelX}px, ${labelY}px)%60;let elementWidth=Math.round(rect.width);let elementHeight=Math.round(rect.height);getElementSize.label.innerText=%60${elementWidth} \u00d7 ${elementHeight}%60;getElementSize.container.style.opacity='1'}}if(getElementSize.isActive){getElementSize.isActive=!1;d.removeEventListener('mousemove',getElementSize.update);getElementSize.container.style.opacity='0';return}getElementSize.isActive=!0;d.addEventListener('mousemove',getElementSize.update);},'el-write':function(){window.designModeActive=!window.designModeActive;if(window.designModeActive){d.body.contentEditable='true';d.designMode='on';}else{d.body.contentEditable='false';d.designMode='off';void 0;}},'inject':function(c){const vI='havitat-viewer';let oC=d.getElementById('havitat-inject-output-container');if(!oC)return'error: output container missing';let r='';try{if(typeof c==='string'&&c.trim().indexOf(':')===0){var cmd=c.trim().slice(1);var cmdR=kernel.exec(cmd);r=(typeof cmdR==='string'?cmdR:JSON.stringify(cmdR,null,2));}else{const sR=eval(c);if(typeof sR!=='undefined'){if(typeof sR==='object'&&sR!==null){r=JSON.stringify(sR,(k,v)=>{if(k==='window'||k==='document'||k==='globalThis')return'...';if(v instanceof HTMLElement)return%60<${v.tagName.toLowerCase()} id="${v.id}" class="${v.className.split(' ').join('.')}" ...>%60;return v;},2);}else if(typeof sR==='function'){r=%60[function] ${sR.name||'anonymous'}%60;}else{r=String(sR);}}else{r='executed: returned undefined';}}}catch(e){r=%60execution error: ${e.name} - ${e.message}%60;}const t='<span style="display:block;margin:0 0 10px;color:#986C98;border-bottom:1px solid #AAABAC25;padding-bottom:5px;font-family:inherit;font-size:14px!important;">output: \'terminal\'</span>';oC.innerHTML=t+'<pre style="margin:0;white-space:pre-wrap;word-break:break-all;color:#AAABAC;font-family:inherit;background-color:#1B1C1C;border:0;font-size:12px!important;overflow-x:auto!important;">'+r+'</pre>';return r;},'help':function(){const vI='havitat-viewer';let oC=d.getElementById('havitat-inject-output-container');if(!oC)return'error: output container missing (run from console viewer)';const t='<span style="display:block;margin:0 0 10px;color:#986C98;border-bottom:1px solid #AAABAC25;padding-bottom:5px;font-family:inherit;font-size:14px!important;">output: \'terminal help\'</span>';let hT='';const commands={'xray-full()':'DOM depth visualization (8 levels).','xray-top()':'Shows DOM depth levels 1 to 4 (top layers).','xray-mid()':'Shows DOM depth levels 5 to 8 (mid layers).','xray-bot()':'Shows DOM depth levels 9 to 12 (deep layers).','v-line()':'Activates vertical line measuring tool.','h-line()':'Activates horizontal line measuring tool.','activate-colors()':'Assigns random background colors to all elements.','el-sniper()':'Activates mode to hide clicked elements.','el-size()':'Activates mode to measure element size on hover.','el-write()':'Toggles page text editing mode (contentEditable).','blur()':'Toggles blur filter on the page.','grayscale()':'Toggles grayscale filter on the page.','img-flip()':'Rotates all images by 90 degrees.','log-fonts()':'Logs a list of all loaded font families.','log-json()':'Logs JSON content if page content type is JSON.','log-this()':'Logs a list of all global (window) properties/objects.','log-tree()':'Logs the DOM structure (body) in ASCII format.','help()':'Shows this command list.','scripts[\'name\']()':'Executes a specific function directly.'};for(const[cmd,desc]of Object.entries(commands)){hT+=%60\n${cmd.padEnd(20)}\u2014 ${desc}%60;}oC.innerHTML=t+'<pre style="margin:0;white-space:pre-wrap;word-break:break-all;color:#AAABAC;font-family:inherit;background-color:#1B1C1C;border:0;font-size:12px!important;overflow-x:auto!important;">'+hT+'</pre>';return'help logged';}};function legacyIsActive(i){try{if(i==='el-sniper')return!!window.elSniperActive;if(i==='el-size')return!!(window.getElementSize&&window.getElementSize.isActive);if(i==='el-write')return!!window.designModeActive;if(i==='blur'||i==='grayscale')return effectStates[i];if(i.indexOf('xray')===0)return!!d.getElementById('havitat-xray')||!!d.getElementById('havitat-xray-top')||!!d.getElementById('havitat-xray-mid')||!!d.getElementById('havitat-xray-bot');if(i==='grid-h')return!!d.getElementById('havitat-grid-h');if(i==='grid-v')return!!d.getElementById('havitat-grid-v');return false;}catch(e){return false;}}var legacyProcessMap={'xray-full':'overlay','xray-top':'overlay','xray-mid':'overlay','xray-bot':'overlay','grid-h':'overlay','grid-v':'overlay','el-sniper':'tool','el-size':'tool','el-write':'tool','blur':'effect','grayscale':'effect','img-flip':'one-shot','v-line':'one-shot','h-line':'one-shot','activate-colors':'one-shot','all-fonts':'one-shot','print-json':'one-shot','log-global':'one-shot','log-domtree':'one-shot','inject':'tool','help':'one-shot'};Object.keys(legacyProcessMap).forEach(function(i){var t=legacyProcessMap[i];if(i==='inject')return;var s={id:i,type:t,active:legacyIsActive(i),start:function(){try{var r=scripts[i]();return r;}catch(e){console.error(e);}},stop:function(){try{var r=scripts[i]();return r;}catch(e){console.error(e);}},teardown:function(){try{var dI=(i==='xray-full'?'havitat-xray':i==='xray-top'?'havitat-xray-top':i==='xray-mid'?'havitat-xray-mid':i==='xray-bot'?'havitat-xray-bot':i==='grid-h'?'havitat-grid-h':i==='grid-v'?'havitat-grid-v':null);if(dI){var el=d.getElementById(dI);if(el)el.remove();}}catch(e){console.error(e);}}};kernel.register(s);});function updateBtnState(b,i){var iA=kernel._internal.processes[i]?kernel._internal.processes[i].active:legacyIsActive(i);var iR=(i==='activate-colors'||i==='v-line'||i==='h-line'||i==='img-flip');if(iA){b.textContent='on';b.style.backgroundColor='#8AB6BB';b.style.color='#1B1C1C';}else{if(!b.textContent.includes('show')&&!iR)b.textContent='off';b.style.backgroundColor=(b.dataset.originalBackground||'#986C98');b.style.color='#1B1C1C';}}const wrapperId='havitat-master-wrapper';let wrapper=d.getElementById(wrapperId);if(wrapper){d.body.style.filter='';effectStates.blur=false;effectStates.grayscale=false;if(window.elSniperActive){scripts['el-sniper']();kernel._internal.processes['el-sniper'].active=false;}if(window.getElementSize&&window.getElementSize.isActive){scripts['el-size']();kernel._internal.processes['el-size'].active=false;}if(window.designModeActive){scripts['el-write']();kernel._internal.processes['el-write'].active=false;}d.getElementById(wrapperId).remove();return;}wrapper=d.createElement('div');wrapper.id=wrapperId;wrapper.style.cssText='position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2147483647;display:flex;gap:15px;align-items:flex-start;';d.body.appendChild(wrapper);const menuId='havitat-menu';let menu=d.createElement('div');menu.id=menuId;menu.style.cssText='background-color:#1B1C1C;border-radius:10px 0 0 10px;padding:20px;box-shadow:0 0 20px rgba(0,0,0,0.5);display:flex;flex-direction:column;gap:15px;color:#AAABAC;font-family:Inconsolata, monospace;font-size:12px!important;width:400px;height:600px;overflow-y:auto;pointer-events:auto;user-select:none;-webkit-user-select:none;';wrapper.appendChild(menu);function createSectionTitle(t){const h4=d.createElement('h4');h4.textContent=t;h4.style.cssText='margin:0;padding:5px 0 0;color:#986C98;text-transform:uppercase;font-size:14px!important;font-family:inherit;';return h4;}function showViewer(i,c,iH,l,b){const vI='havitat-viewer';let v=d.getElementById(vI);const cV=activeViewerId;if(v&&cV===i){v.remove();activeViewerId=null;b.textContent='show';b.style.backgroundColor='#986C98';return;}if(v){const oB=d.getElementById(cV+'_btn');if(oB){oB.textContent='show';oB.style.backgroundColor='#986C98';}}const vH='600px';const s='background-color:#1B1C1C;padding:15px;width:700px;height:'+vH+';color:#AAABAC;font-family:Inconsolata, monospace;font-size:12px!important;border-radius:0;overflow-y:auto;overflow-x:auto;box-shadow:0 0 20px rgba(0,0,0,0.5);';if(!v){v=d.createElement('div');v.id=vI;wrapper.appendChild(v);}v.style.cssText=s;v.style.pointerEvents='all';const t='<span style="display:block;margin:0 0 10px;color:#986C98;border-bottom:1px solid #AAABAC25;padding-bottom:5px;font-family:inherit;font-size:14px!important;">output: \''+l+'\'</span>';if(iH)v.innerHTML=t+c;else v.innerHTML=t+'<pre style="margin:0;white-space:pre;color:#AAABAC;word-break:keep-all;font-family:inherit;background-color:#1B1C1C;border:0;font-size:12px!important;overflow-x:auto!important;">'+c+'</pre>';activeViewerId=i;b.textContent='close';b.style.backgroundColor='#8AB6BB';}function createXrayToggle(i,l){const div=d.createElement('div');div.style.cssText='display:flex;justify-content:space-between;align-items:center;';const lt=d.createElement('span');lt.textContent=l;const b=d.createElement('button');b.textContent='off';b.style.cssText='padding:3px 8px;background-color:#986C98;color:#1B1C1C;border:1px solid #AAABAC25;border-radius:5px;cursor:pointer;min-width:50px;font-family:inherit;font-size:11px;pointer-events:all;';b.dataset.originalBackground='#986C98';b.id=i+'_btn';b.onclick=function(){kernel.toggle(i);setTimeout(function(){updateBtnState(b,i);},50);};updateBtnState(b,i);div.appendChild(lt);div.appendChild(b);return div;}function createGridControl(i,l,def){const div=d.createElement('div');div.style.cssText='display:flex;justify-content:space-between;align-items:center;';const lt=d.createElement('span');lt.textContent=l;const inp=d.createElement('input');inp.type='number';inp.value=def;inp.min='1';inp.style.cssText='padding:3px 5px;width:50px;border:1px solid #AAABAC25;border-radius:5px;background-color:#AAABAC;color:#1B1C1C;font-family:inherit;font-size:11px;pointer-events:all;';const b=d.createElement('button');b.textContent='off';b.style.cssText='padding:3px 8px;background-color:#986C98;color:#1B1C1C;border:1px solid #AAABAC25;border-radius:5px;cursor:pointer;min-width:50px;font-family:inherit;font-size:11px;pointer-events:all;';b.dataset.originalBackground='#986C98';b.id=i+'_btn';var a=false;a=legacyIsActive(i);function r(){if(a){var o=d.getElementById(i==='grid-h'?'havitat-grid-h':'havitat-grid-v');if(o)o.remove();scripts[i](parseFloat(inp.value)||1);}}function t(){scripts[i](parseFloat(inp.value)||1);a=!a;b.textContent=a?'on':'off';b.style.backgroundColor=a?'#8AB6BB':'#986C98';b.style.color='#1B1C1C';kernel._internal.processes[i].active=a;}b.onclick=function(){t();};inp.addEventListener('input',r);inp.addEventListener('change',r);inp.addEventListener('keypress',function(e){if(e.key==='Enter'){e.preventDefault();a?r():t();}});if(a)b.textContent='on';updateBtnState(b,i);div.appendChild(lt);div.appendChild(inp);div.appendChild(b);return div;}function createEffectToggle(i,l){const div=d.createElement('div');div.style.cssText='display:flex;justify-content:space-between;align-items:center;';const lt=d.createElement('span');lt.textContent=l;const b=d.createElement('button');b.id=i+'_btn';b.textContent='off';b.dataset.originalBackground='#986C98';b.style.cssText='padding:3px 8px;background-color:#986C98;color:#1B1C1C;border:1px solid #AAABAC25;border-radius:5px;cursor:pointer;min-width:50px;font-family:inherit;font-size:11px;pointer-events:all;';b.onclick=function(){scripts[i]();var iA=effectStates[i];b.textContent=iA?'on':'off';b.style.backgroundColor=iA?'#8AB6BB':'#986C98';b.style.color='#1B1C1C';kernel._internal.processes[i].active=iA;};updateBtnState(b,i);div.appendChild(lt);div.appendChild(b);return div;}function createToolToggle(i,l){const div=d.createElement('div');div.style.cssText='display:flex;justify-content:space-between;align-items:center;';const lt=d.createElement('span');lt.textContent=l;const b=d.createElement('button');b.id=i+'_btn';b.textContent='off';b.dataset.originalBackground='#986C98';b.style.cssText='padding:3px 8px;background-color:#986C98;color:#1B1C1C;border:1px solid #AAABAC25;border-radius:5px;cursor:pointer;min-width:50px;font-family:inherit;font-size:11px;pointer-events:all;';b.onclick=function(){kernel.toggle(i);setTimeout(function(){updateBtnState(b,i);},50);};updateBtnState(b,i);div.appendChild(lt);div.appendChild(b);return div;}function createOneShotButton(i,l){const div=d.createElement('div');div.style.cssText='display:flex;justify-content:space-between;align-items:center;';const lt=d.createElement('span');lt.textContent=l;const b=d.createElement('button');b.id=i+'_btn';const iR=(i==='activate-colors'||i==='v-line'||i==='h-line'||i==='img-flip');b.textContent=iR?'run':'show';b.style.cssText='padding:3px 8px;background-color:#986C98;color:#1B1C1C;border:1px solid #AAABAC25;border-radius:5px;cursor:pointer;min-width:50px;font-family:inherit;font-size:11px;pointer-events:all;';b.onclick=function(){if(b.textContent==='close'){showViewer(i,null,false,l,b);return;}if(!b.textContent.includes('show')){scripts[i]();return;}var iH=(i==='print-json');var c=scripts[i]();showViewer(i,c,iH,l,b);};div.appendChild(lt);div.appendChild(b);return div;}function createInjectControl(i,l){const div=d.createElement('div');div.style.cssText='display:flex;justify-content:center;width:100%;flex-grow:1;';const b=d.createElement('button');b.id=i+'_btn';b.textContent=l;b.style.cssText='padding:5px 10px;background-color:#986C98;color:#1B1C1C;border:1px solid #AAABAC25;border-radius:5px;cursor:pointer;font-family:inherit;flex-grow:1;pointer-events:all;';const vI='havitat-viewer';const tI='havitat-inject-textarea';function iRH(){const t=d.getElementById(tI);const c=t?t.value:'';if(c.trim()){scripts[i](c);}}function tV(){let v=d.getElementById(vI);const cV=activeViewerId;if(v&&cV===i){v.remove();activeViewerId=null;b.textContent=l;b.style.backgroundColor='#986C98';return;}if(v){const oB=d.getElementById(cV+'_btn');if(oB){oB.textContent=oB.dataset.originalLabel||'show';oB.style.backgroundColor='#986C98';}}b.dataset.originalLabel=l;const vH='600px';const s='background-color:#1B1C1C;padding:15px;width:700px;height:'+vH+';color:#AAABAC;font-family:Inconsolata, monospace;font-size:12px!important;border-radius:0;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 0 20px rgba(0,0,0,0.5);pointer-events:all;';if(!v){v=d.createElement('div');v.id=vI;wrapper.appendChild(v);}v.style.cssText=s;const t='<span style="display:block;margin:0 0 10px;color:#986C98;border-bottom:1px solid #AAABAC25;padding-bottom:5px;font-family:inherit;font-size:14px!important;">tool: \''+l+'\'</span>';const tA=d.createElement('textarea');tA.id=tI;tA.style.cssText='flex-grow:0;height:100px;background-color:#1B1C1C;color:#8AB6BB;border:1px solid #AAABAC25;padding:10px;font-family:inherit;font-size:12px;resize:vertical;min-height:50px;margin-bottom:10px;outline: none;box-shadow: none;pointer-events:all;user-select:text;-webkit-user-select:text;';tA.placeholder='// enter javascript code here. use \'return\' to show a value. prefix with : for kernel commands, e.g. :ps';const oC=d.createElement('div');oC.style.cssText='flex-grow:1;overflow-y:auto;background-color:#1B1C1C;border:1px solid #AAABAC25;padding:10px;color:#AAABAC;font-family:inherit;font-size:12px;margin-bottom:10px;pointer-events:all;user-select:text;-webkit-user-select:text;';oC.id='havitat-inject-output-container';const rB=d.createElement('button');rB.textContent='run script';rB.style.cssText='padding:5px 10px;background-color:#986C98;color:#1B1C1C;border:1px solid #AAABAC25;border-radius:5px;cursor:pointer;font-family:inherit;width:49%;pointer-events:all;';rB.onclick=function(){var c=(d.getElementById(tI)||{}).value||'';if(c.trim()&&c.trim().indexOf(':')===0){var o=kernel.exec(c.trim().slice(1));var r=(typeof o==='string')?o:JSON.stringify(o,(k,v)=>{if(k==='raw'&&v&&v.tagName)return%60<${v.tagName.toLowerCase()}#${v.id}>%60;return v;},2);oC.innerHTML='<span style="display:block;margin:0 0 10px;color:#986C98;border-bottom:1px solid #AAABAC25;padding-bottom:5px;font-family:inherit;font-size:14px!important;">output: \''+l+'\'</span><pre style="margin:0;white-space:pre-wrap;word-break:break-all;color:#AAABAC;font-family:inherit;background-color:#1B1C1C;border:0;font-size:12px!important;">'+r+'</pre>';}else{iRH();}};const hB=d.createElement('button');hB.textContent='help';hB.style.cssText='padding:5px 10px;background-color:#8AB6BB;color:#1B1C1C;border:1px solid #AAABAC25;border-radius:5px;cursor:pointer;font-family:inherit;width:49%;pointer-events:all;';hB.onclick=function(){scripts['help']();};const bR=d.createElement('div');bR.style.cssText='display:flex;justify-content:space-between;gap:10px;pointer-events:all;';bR.appendChild(rB);bR.appendChild(hB);v.innerHTML='';v.appendChild(d.createRange().createContextualFragment(t));v.appendChild(tA);v.appendChild(oC);v.appendChild(bR);activeViewerId=i;b.textContent='close';b.style.backgroundColor='#8AB6BB';const oT='<span style="display:block;margin:0 0 10px;color:#986C98;border-bottom:1px solid #AAABAC25;padding-bottom:5px;font-family:inherit;font-size:14px!important;">output: \''+l+'\'</span>';oC.innerHTML=oT+'<pre style="margin:0;white-space:pre-wrap;word-break:break-all;color:#AAABAC;font-family:inherit;background-color:#1B1C1C;border:0;font-size:12px!important;">// execution results will appear here</pre>';}b.onclick=tV;div.appendChild(b);return div;}const title=d.createElement('h3');title.textContent='DOM MATRIX';title.style.cssText='margin:0;text-align:center;color:#986C98;border-bottom:1px solid #AAABAC25;padding-bottom:10px;font-family:inherit;';menu.appendChild(title);menu.appendChild(createSectionTitle('dom depth'));menu.appendChild(createXrayToggle('xray-full','xray-dom [1x08]:'));menu.appendChild(createXrayToggle('xray-top','xray-top [1x04]:'));menu.appendChild(createXrayToggle('xray-mid','xray-mid [5x08]:'));menu.appendChild(createXrayToggle('xray-bot','xray-bot [9x12]:'));let hr0=d.createElement('hr');hr0.style.cssText='width:100%;border:0;border-top:1px solid #AAABAC25;margin:10px 0;';menu.appendChild(hr0);menu.appendChild(createSectionTitle('elements'));menu.appendChild(createToolToggle('el-sniper','el-sniper'));menu.appendChild(createToolToggle('el-size','el-size'));menu.appendChild(createToolToggle('el-write','el-write'));let hr1=d.createElement('hr');hr1.style.cssText='width:100%;border:0;border-top:1px solid #AAABAC25;margin:10px 0;';menu.appendChild(hr1);menu.appendChild(createSectionTitle('grids'));menu.appendChild(createGridControl('grid-h','h-grid [rem]:',5));menu.appendChild(createGridControl('grid-v','v-grid [rem]:',5));menu.appendChild(createOneShotButton('v-line','v-line [cur]:'));menu.appendChild(createOneShotButton('h-line','h-line [cur]:'));menu.appendChild(createOneShotButton('activate-colors','layout [colors]'));let hr2=d.createElement('hr');hr2.style.cssText='width:100%;border:0;border-top:1px solid #AAABAC25;margin:10px 0;';menu.appendChild(hr2);menu.appendChild(createSectionTitle('prints'));menu.appendChild(createOneShotButton('all-fonts','log-fonts'));menu.appendChild(createOneShotButton('print-json','log-json'));menu.appendChild(createOneShotButton('log-global','log-this'));menu.appendChild(createOneShotButton('log-domtree','log-tree'));let hr4=d.createElement('hr');hr4.style.cssText='width:100%;border:0;border-top:1px solid #AAABAC25;margin:10px 0;';menu.appendChild(hr4);menu.appendChild(createSectionTitle('image'));menu.appendChild(createOneShotButton('img-flip','flip [90Â°]'));let hr3=d.createElement('hr');hr3.style.cssText='width:100%;border:0;border-top:1px solid #AAABAC25;margin:10px 0;';menu.appendChild(hr3);menu.appendChild(createSectionTitle('effects'));menu.appendChild(createEffectToggle('blur','blur'));menu.appendChild(createEffectToggle('grayscale','grayscale'));const closeButtonContainer=d.createElement('div');closeButtonContainer.style.cssText='display:flex;justify-content:space-between;gap:10px;margin-top:15px;pointer-events:all;';menu.appendChild(closeButtonContainer);const consolaButtonWrapper=createInjectControl('inject','terminal');consolaButtonWrapper.style.cssText='display:flex;justify-content:center;width:100%;flex-grow:1;pointer-events:all;';consolaButtonWrapper.children[0].style.flexGrow='1';closeButtonContainer.appendChild(consolaButtonWrapper);const closeButton=d.createElement('button');closeButton.textContent='cerrar';closeButton.style.cssText='padding:5px 10px;background-color:#986C98;color:#1B1C1C;border:1px solid #AAABAC25;border-radius:5px;cursor:pointer;font-family:inherit;flex-grow:1.5;pointer-events:all;';closeButton.onclick=function(){d.body.style.filter='';effectStates.blur=false;effectStates.grayscale=false;if(window.elSniperActive){scripts['el-sniper']();kernel._internal.processes['el-sniper'].active=false;}if(window.getElementSize&&window.getElementSize.isActive){scripts['el-size']();kernel._internal.processes['el-size'].active=false;}if(window.designModeActive){scripts['el-write']();kernel._internal.processes['el-write'].active=false;}const v=d.getElementById('havitat-viewer');if(v)v.remove();d.getElementById(wrapperId).remove();};closeButtonContainer.appendChild(closeButton);WIN.havitat=WIN.havitat||{};WIN.havitat.kernel=kernel;WIN.havitat.scripts=scripts;WIN.havitat.wrap=kernel.wrap;WIN.havitat.scan=kernel.scan;function updateBodyFilter(){let f=[];if(effectStates.blur)f.push('blur(5px)');if(effectStates.grayscale)f.push('grayscale(100%)');d.body.style.filter=f.join(' ');}})()})();
